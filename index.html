<!doctype html>
<html lang="vi">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tìm người ở ghép</title>

  <!-- Bootstrap CSS (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
    :root {
      --brand: #ff7a59;
      --muted: #6c757d;
      --chip-active-bg: #0d6efd;
    }

    body {
      background: #fdf5ed;
    }

    .hero {
      background: linear-gradient(90deg, rgba(255, 122, 89, 0.06), rgba(255, 122, 89, 0.02));
      padding: 3rem 0;
    }

    .card-price {
      font-weight: 700;
      color: var(--brand);
    }

    .avatar-sm {
      width: 38px;
      height: 38px;
      object-fit: cover;
      border-radius: 50%;
    }

    .filter-chip {
      cursor: pointer;
      color: #333;
      transition: all .12s;
    }

    .filter-chip:hover {
      color: var(--chip-active-bg);
    }

    .filter-chip.chip--active {
      background: var(--chip-active-bg) !important;
      color: #fff !important;
      border-color: var(--chip-active-bg) !important;
    }

    .no-outline:focus {
      outline: none;
      box-shadow: none;
    }

    /* text-truncate trong card-body */
    .card .card-body .text-truncate {
      display: block;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    /* focus styles để đảm bảo accessibility (không tắt hoàn toàn outline) */
    .filter-chip:focus {
      outline: 0;
      box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }

    button:focus,
    .form-control:focus,
    .form-select:focus {
      box-shadow: 0 0 0 0.15rem rgba(13, 110, 253, 0.15);
    }
  </style>
</head>

<body>

  <!-- Header -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#">Tìm Ở Ghép</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain"
        aria-controls="navMain" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navMain">
        <ul class="navbar-nav ms-auto align-items-lg-center">
          <li class="nav-item me-2"><a class="nav-link" href="#">Đăng tin</a></li>
          <li class="nav-item me-2"><a class="nav-link" href="#">Hướng dẫn</a></li>
          <li class="nav-item"><button class="btn btn-outline-primary">Đăng nhập</button></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero + Search -->
  <section class="hero">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-6">
          <h1 class="display-6 fw-semibold">Ở Ghép</h1>
          <p class="text-muted">Tìm bạn cùng phòng theo khu vực, ngân sách và giới tính.</p>

          <!-- Form tìm kiếm -->
          <form id="searchForm" class="row g-2" aria-label="Form tìm kiếm">
            <div class="col-12 col-md-6">
              <label class="visually-hidden" for="qLocation">Khu vực</label>
              <input id="qLocation" name="location" class="form-control" placeholder="Khu vực (ví dụ: Cần Thơ)" />
            </div>
            <div class="col-6 col-md-3">
              <label class="visually-hidden" for="qGender">Giới tính</label>
              <select id="qGender" name="gender" class="form-select">
                <option value="">Giới tính</option>
                <option value="male">Nam</option>
                <option value="female">Nữ</option>
                <option value="any">Không quan trọng</option>
              </select>
            </div>
            <div class="col-6 col-md-3">
              <label class="visually-hidden" for="qPrice">Giá tối đa</label>
              <div class="input-group">
                <span class="input-group-text">₫</span>
                <input id="qPrice" name="price" type="number" class="form-control" placeholder="Max / tháng" min="0" />
              </div>
            </div>

            <div class="col-12 d-grid d-md-inline-flex gap-2">
              <button type="submit" class="btn btn-primary">Tìm kiếm</button>
              <button type="button" id="clearBtn" class="btn btn-outline-secondary">Xóa</button>
            </div>
          </form>

          <!-- Chips tiện ích -->
          <div class="mt-3 d-flex flex-wrap gap-2" role="list" aria-label="Tiện ích">
            <span tabindex="0" class="badge bg-light border filter-chip px-2 py-1" data-amenity="wifi">Wifi mạnh</span>
            <span tabindex="0" class="badge bg-light border filter-chip px-2 py-1" data-amenity="dien-nuoc">Điện
              nước</span>
            <span tabindex="0" class="badge bg-light border filter-chip px-2 py-1" data-amenity="may-giat">Có máy
              giặt</span>
            <span tabindex="0" class="badge bg-light border filter-chip px-2 py-1" data-amenity="an-ninh">An Ninh</span>
            <span tabindex="0" class="badge bg-light border filter-chip px-2 py-1" data-amenity="dieu-hoa">Có điều
              hòa</span>
            <span tabindex="0" class="badge bg-light border filter-chip px-2 py-1" data-amenity="dau-xe">Có chỗ đậu
              xe</span>
            <span tabindex="0" class="badge bg-light border filter-chip px-2 py-1" data-amenity="noi-that">Có nội
              thất</span>
          </div>
        </div>

        <div class="col-lg-6 d-none d-lg-block text-end">
          <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800&q=60" alt="room"
            class="img-fluid rounded shadow-sm" style="max-height:220px; object-fit:cover;">
        </div>
      </div>
    </div>
  </section>

  <!-- bộ lọc + kết quả -->
  <main class="py-4">
    <div class="container">
      <div class="row g-3">
        <!-- Sidebar filters -->
        <aside class="col-12 col-md-4 col-lg-3">
          <div class="card mb-3">
            <div class="card-body">
              <h6 class="mb-3">Bộ lọc</h6>
              <div class="mb-2">
                <label class="form-label mb-1" for="roomType">Loại phòng</label>
                <select id="roomType" class="form-select" aria-label="Loại phòng">
                  <option value="">Tất cả</option>
                  <option value="private">Phòng riêng</option>
                  <option value="shared">Phòng ghép</option>
                </select>
              </div>
              <hr>
              <button id="applyFilters" class="btn btn-sm btn-primary w-100">Áp dụng</button>
            </div>
          </div>
        </aside>

        <!-- Listing -->
        <section class="col-12 col-md-8 col-lg-9">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <div><strong id="resultCount">0</strong> kết quả</div>
            <div class="text-muted small">Sắp xếp:
              <select id="sortBy" class="form-select form-select-sm d-inline-block w-auto ms-2" aria-label="Sắp xếp">
                <option value="new">Mới nhất</option>
                <option value="price_asc">Giá thấp → cao</option>
                <option value="price_desc" selected>Giá cao → thấp</option>
                <option value="rating_desc">Đánh giá</option>
              </select>
            </div>
          </div>

          <div id="list" class="row g-3">
            <!-- Card mẫu 1 -->
            <div class="col-12 col-md-6 listing-card" data-location="cần thơ" data-gender="male" data-price="1200000"
              data-amenities="wifi;may-giat;dien-nuoc">
              <article class="card h-100">
                <div class="row g-0">
                  <div class="col-5">
                    <img src="https://images.unsplash.com/photo-1505691723518-36a5b3b6a9d5?w=600&q=60"
                      class="img-fluid rounded-start" alt="room">
                  </div>
                  <div class="col-7">
                    <div class="card-body d-flex flex-column">
                      <div class="d-flex justify-content-between align-items-start">
                        <h6 class="card-title mb-0">Phòng gần Đại học Cần Thơ</h6>
                        <div class="text-end">
                          <div class="card-price">1.200.000đ</div>
                          <div class="text-muted small">/tháng</div>
                        </div>
                      </div>
                      <p class="text-muted small mb-2">Quận Ninh Kiều • 20 m² • Ghép Nam</p>
                      <p class="mb-2 small text-truncate">Phòng sạch sẽ, có máy giặt, wifi, tủ quần áo. Tìm bạn thuê
                        chung (Nam).</p>

                      <div class="mt-auto d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                          <img src="IMAGES/ảnh bựa/z7050544895144_5cde9c1ef9053c1375f5f5efcbb93612.jpg"
                            class="avatar-sm me-2" alt="avatar" />
                          <div class="small">
                            <div class="fw-semibold">THANH TÂM</div>
                            <div class="text-muted">Chủ trọ</div>
                          </div>
                        </div>

                        <div>
                          <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal"
                            data-bs-target="#detailModal">Xem</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </article>
            </div>

            <!-- Card mẫu 2 -->
            <div class="col-12 col-md-6 listing-card" data-location="cần thơ" data-gender="female" data-price="900000"
              data-amenities="wifi;dien-nuoc">
              <article class="card h-100">
                <div class="row g-0">
                  <div class="col-5">
                    <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=600&q=60"
                      class="img-fluid rounded-start" alt="room">
                  </div>
                  <div class="col-7">
                    <div class="card-body d-flex flex-column">
                      <div class="d-flex justify-content-between align-items-start">
                        <h6 class="card-title mb-0">Phòng gần CTU</h6>
                        <div class="text-end">
                          <div class="card-price">1.000.000đ</div>
                          <div class="text-muted small">/tháng</div>
                        </div>
                      </div>
                      <p class="text-muted small mb-2">Quận Ninh Kiều • 15 m² • Ghép Nữ</p>
                      <p class="mb-2 small text-truncate">Phòng sạch, giá rẻ, ưu tiên nữ.</p>

                      <div class="mt-auto d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                          <img src="IMAGES/ảnh bựa/ác quỉ.jpg" class="avatar-sm me-2" alt="avatar" />
                          <div class="small">
                            <div class="fw-semibold">PHẠM XUÂN MAI</div>
                            <div class="text-muted">Người Thuê</div>
                          </div>
                        </div>

                        <div>
                          <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal"
                            data-bs-target="#detailModal">Xem</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </article>
            </div>

            <!-- Bạn có thể nhân bản thêm card với cùng cấu trúc .listing-card -->
          </div>

          <!-- Pagination (mẫu) -->
          <nav class="mt-4" aria-label="Pagination">
            <ul class="pagination justify-content-center">
              <li class="page-item disabled"><a class="page-link">Trước</a></li>
              <li class="page-item active"><a class="page-link">1</a></li>
              <li class="page-item"><a class="page-link">2</a></li>
              <li class="page-item"><a class="page-link">Sau</a></li>
            </ul>
          </nav>
        </section>
      </div>
    </div>
  </main>

  <!-- Modal -->
  <div class="modal fade" id="detailModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Chi tiết tin</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
        </div>
        <div class="modal-body">
          <div class="row g-3">
            <div class="col-md-6">
              <img src="https://images.unsplash.com/photo-1505691723518-36a5b3b6a9d5?w=900&q=60"
                class="img-fluid rounded" alt="">
            </div>
            <div class="col-md-6">
              <h5 class="fw-semibold">Phòng gần Đại học Cần Thơ</h5>
              <p class="mb-1"><strong class="card-price">1.200.000đ</strong> <span class="text-muted">/tháng</span></p>
              <p class="text-muted small">Địa chỉ: Quận Ninh Kiều, Cần Thơ</p>
              <p>Mô tả: Phòng sạch, có nội thất cơ bản, ưu tiên nam. Liên hệ: 09xx...</p>
              <div class="mt-3">
                <a href="tel:099999999" class="btn btn-success me-2">Gọi ngay</a>
                <a href="#" class="btn btn-outline-primary">Nhắn</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Script: normalize, filter, sort -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const listEl = document.getElementById('list');
      const resultCountEl = document.getElementById('resultCount');
      const searchForm = document.getElementById('searchForm');
      const clearBtn = document.getElementById('clearBtn');
      const sortBy = document.getElementById('sortBy');
      const applyFiltersBtn = document.getElementById('applyFilters');

      function normalizeDataPrice() {
        document.querySelectorAll('.listing-card').forEach(card => {
          if (!card.dataset.price) {
            const priceEl = card.querySelector('.card-price');
            if (priceEl) card.dataset.price = (priceEl.textContent || '').replace(/[^\d]/g, '') || '0';
          }
          if (card.dataset.amenities) {
            card.dataset.amenities = card.dataset.amenities.toLowerCase().replace(/\s+/g, '');
          }
        });
      }

      function getActiveAmenities() {
        return Array.from(document.querySelectorAll('.filter-chip.chip--active'))
          .map(el => (el.dataset.amenity || '').toLowerCase().replace(/\s+/g, ''))
          .filter(Boolean);
      }

      function applyFilter() {
        const qLocation = document.getElementById('qLocation').value.trim().toLowerCase();
        const qGender = document.getElementById('qGender').value;
        const qPrice = parseInt(document.getElementById('qPrice').value || '0', 10);
        const roomType = document.getElementById('roomType') ? document.getElementById('roomType').value : '';
        const activeAmenities = getActiveAmenities();

        let visible = 0;
        listEl.querySelectorAll('.listing-card').forEach(card => {
          const loc = (card.dataset.location || '').toLowerCase();
          const gender = (card.dataset.gender || '').toLowerCase();
          const price = parseInt(card.dataset.price || '0', 10);
          const amenities = (card.dataset.amenities || '').toLowerCase();
          const type = (card.dataset.type || '').toLowerCase();

          let ok = true;
          if (qLocation && !loc.includes(qLocation)) ok = false;
          if (qGender && qGender !== '' && qGender !== 'any' && gender !== qGender.toLowerCase()) ok = false;
          if (qPrice && qPrice > 0 && price > qPrice) ok = false;
          if (roomType && roomType !== '' && type !== '' && type !== roomType.toLowerCase()) ok = false;
          if (activeAmenities.length && activeAmenities.some(a => !amenities.includes(a))) ok = false;

          card.style.display = ok ? '' : 'none';
          if (ok) visible++;
        });

        if (resultCountEl) resultCountEl.textContent = visible;
      }

      function sortByPrice(mode = 'price_desc') {
        const cards = Array.from(listEl.querySelectorAll('.listing-card'));
        cards.sort((a, b) => {
          const pa = parseInt(a.dataset.price || '0', 10);
          const pb = parseInt(b.dataset.price || '0', 10);
          return mode === 'price_asc' ? pa - pb : pb - pa;
        });
        const frag = document.createDocumentFragment();
        cards.forEach(c => frag.appendChild(c));
        listEl.innerHTML = '';
        listEl.appendChild(frag);
      }

      // Event delegation cho chip (click + keyboard Enter/Space)
      document.addEventListener('click', (e) => {
        const chip = e.target.closest('.filter-chip');
        if (!chip) return;
        chip.classList.toggle('chip--active');
        applyFilter();
      });
      document.addEventListener('keydown', (e) => {
        const chip = e.target.closest && e.target.closest('.filter-chip');
        if (!chip) return;
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          chip.classList.toggle('chip--active');
          applyFilter();
        }
      });

      if (searchForm) {
        searchForm.addEventListener('submit', (e) => {
          e.preventDefault();
          applyFilter();
        });
      }

      if (clearBtn) {
        clearBtn.addEventListener('click', () => {
          ['qLocation', 'qPrice', 'qGender'].forEach(id => {
            const el = document.getElementById(id);
            if (el) el.value = '';
          });
          if (document.getElementById('roomType')) document.getElementById('roomType').value = '';
          document.querySelectorAll('.filter-chip').forEach(ch => ch.classList.remove('chip--active'));
          applyFilter();
        });
      }

      if (applyFiltersBtn) {
        applyFiltersBtn.addEventListener('click', () => applyFilter());
      }

      if (sortBy) {
        sortBy.addEventListener('change', (e) => {
          const mode = e.target.value;
          if (mode === 'price_asc' || mode === 'price_desc') sortByPrice(mode);
          applyFilter();
        });
      }

      // Khởi tạo
      normalizeDataPrice();
      // sắp xếp mặc định theo select hiện tại
      if (sortBy && (sortBy.value === 'price_asc' || sortBy.value === 'price_desc')) sortByPrice(sortBy.value);
      applyFilter();
    });
  </script>
</body>

</html>